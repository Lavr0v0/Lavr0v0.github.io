# Character Forge V7.1 新功能

## 🎉 重大更新：完整的导出系统

### 新增功能一览

#### 📸 照片上传
- 在右侧预览面板顶部添加了照片上传区域
- 尺寸：128x128 像素
- 支持所有常见图片格式（JPG、PNG、GIF、WebP）
- 点击虚线框即可上传
- 点击右上角 X 按钮删除照片

#### 📤 多格式导出

在预览面板右上角新增 4 个导出按钮：

| 按钮 | 格式 | 说明 |
|------|------|------|
| 📄 | TXT | 纯文本格式，带 ═══ 边框装饰，属性显示为 ★☆ 星级 |
| 📝 | Markdown | 标准 MD 格式，照片以 Base64 嵌入，属性以表格展示 |
| 🖼️ | PNG | 高清截图（2x scale），包含完整预览卡片样式 |
| 📋 | 复制 | 一键复制纯文本到剪贴板 |

#### 🎨 界面优化
- 预览面板所有区块都添加了 Font Awesome 图标
- 导出按钮图标化，hover 效果优化
- 照片区域设计精美，交互流畅

---

## 📋 导出格式详解

### TXT 格式
```
═══════════════════════════════════════
  角色档案 - 张三
═══════════════════════════════════════

【基础信息】
姓名: 张三
职业: 战士
性别: 男
种族: 人类
年龄: 25
身高: 180cm
阵营: 守序善良

【属性】
力量: ★★★★☆ (4/5)
敏捷: ★★★☆☆ (3/5)
...

【外貌特征】
头发: 短发 直发 (黑色)
眼睛: 棕色 圆形
...

═══════════════════════════════════════
生成时间: 2024/2/13 11:30:00
═══════════════════════════════════════
```

### Markdown 格式
```markdown
# 张三

![角色照片](data:image/png;base64,...)

## 基础信息

- **姓名**: 张三
- **职业**: 战士
- **性别**: 男
...

## 属性

| 属性 | 等级 |
|------|------|
| 力量 | ★★★★☆ (4/5) |
| 敏捷 | ★★★☆☆ (3/5) |
...

## 外貌特征

- **头发**: 短发 直发 (黑色)
- **眼睛**: 棕色 圆形
...
```

### PNG 格式
- 预览卡片的高清截图
- 包含所有视觉元素（照片、图标、文字）
- 2倍分辨率，适合打印和分享
- 首次使用自动加载 html2canvas 库

### 复制文本
- 与 TXT 格式相同
- 直接复制到剪贴板
- 可粘贴到任何文本编辑器

---

## 🚀 使用方法

### 上传照片
1. 在右侧预览面板找到照片区域（顶部）
2. 点击虚线框
3. 选择图片文件
4. 照片立即显示在预览中
5. 如需删除，点击右上角 X 按钮

### 导出文件
1. 确保已填写角色信息
2. （可选）上传照片
3. 点击预览面板右上角的导出按钮：
   - 📄 导出 TXT
   - 📝 导出 Markdown
   - 🖼️ 导出图片
   - 📋 复制文本
4. 文件自动下载（或复制成功提示）

---

## 💡 使用技巧

### 照片建议
- **尺寸**: 建议使用正方形图片
- **大小**: < 1MB（避免文件过大）
- **格式**: JPG 或 PNG（兼容性最好）
- **内容**: 角色头像、全身照、概念图等

### 导出场景

| 场景 | 推荐格式 | 原因 |
|------|----------|------|
| 快速分享给朋友 | 📋 复制 | 最快捷 |
| 保存到笔记软件 | 📝 Markdown | 格式化好，支持照片 |
| 打印或存档 | 📄 TXT | 纯文本，兼容性强 |
| 社交媒体分享 | 🖼️ PNG | 视觉效果好 |
| 团队协作 | 📝 Markdown | 支持版本控制 |

### 文件命名
所有导出文件都使用统一命名格式：
```
[角色名]_档案_[时间戳].[扩展名]

示例：
张三_档案_1707804600000.txt
张三_档案_1707804600000.md
张三_档案_1707804600000.png
```

---

## 🔧 技术细节

### 照片存储
- 使用 FileReader API 读取图片
- 转换为 Base64 格式存储在内存中
- 不上传到服务器，完全本地处理
- 刷新页面后需要重新上传

### 导出实现
- **TXT/MD**: 使用 Blob API 创建文件
- **PNG**: 使用 html2canvas 库截图
- **复制**: 使用 Clipboard API

### 浏览器兼容性
- Chrome 90+: ✅ 完全支持
- Firefox 88+: ✅ 完全支持
- Safari 14+: ✅ 完全支持
- Edge 90+: ✅ 完全支持

---

## 📊 性能优化

除了新功能，V7.1 还进行了全面的性能优化：

### 动画优化
- ✅ 启用硬件加速
- ✅ 简化动画效果
- ✅ 缩短动画时长
- ✅ 优化缓动函数

### 性能提升
- CPU 使用率降低 60%（50% → 20%）
- FPS 提升 33%（45 → 60）
- 动画响应速度提升 40%

详细说明请查看 [docs/性能优化说明.md](docs/性能优化说明.md)

---

## 📚 相关文档

- [导出功能说明](docs/导出功能说明.md) - 详细的导出功能文档
- [快速开始](docs/快速开始.md) - 5 分钟上手指南
- [使用指南](docs/使用指南.md) - 完整使用说明
- [更新日志](docs/CHANGELOG.md) - 完整更新记录

---

## 🧪 测试

使用 `tests/test-export.html` 测试所有导出功能：
1. 照片上传和删除
2. TXT 导出
3. Markdown 导出（含照片）
4. PNG 导出（含照片）
5. 复制文本

---

## 🎯 下一步

1. 打开 `index.html`
2. 创建一个角色
3. 上传照片
4. 尝试所有导出格式
5. 分享你的角色！

---

## 💬 反馈

如果你发现任何问题或有改进建议，欢迎反馈！

---

**Character Forge V7.1** - 让角色创作更完整 ✨

更新时间：2024-02-13

# Character Forge V7.0 使用指南

## 快速开始

### 打开程序
直接打开 `index.html` 文件即可开始使用

### API 配置

#### 方式 1: 开发者模式（推荐用于测试）
如果你有开发者密码，可以快速启用预配置的 API：
1. 点击右上角齿轮图标打开"API 设置"
2. 在"API Key"标签右侧，点击"开发者模式"
3. 输入密码：`131313`
4. 自动配置完成！

详细说明请查看 [开发者模式说明.md](开发者模式说明.md)

#### 方式 2: 使用自己的 API（推荐用于正式使用）
1. 点击右上角齿轮图标打开"API 设置"
2. 选择服务商（OpenAI、Gemini、DeepSeek 等）
3. 输入你的 API Key
4. 点击"测试连接"验证
5. 点击"保存"

**获取 API Key**：
- OpenAI: https://platform.openai.com/api-keys
- Google Gemini: https://aistudio.google.com/app/apikey
- DeepSeek: https://platform.deepseek.com/api_keys

---

## 5 步创建流程

### Step 1: 基础档案
填写角色的基本信息：
- 姓名、性别、年龄、身高
- 种族、职业、阵营
- 12 个属性点数（力量、敏捷、体质等）
- 13 个性格滑块（内向/外向、冷静/冲动等）

**提示**：可以点击"随机数值"快速生成，或点击"生成"按钮让 AI 生成姓名和种族

---

### Step 2: 外貌具象化
选择角色的外貌特征（支持多选）：
- 头发：长度、风格、颜色
- 眼睛：形状、颜色
- 面部：肤色、脸型、特殊标记（疤痕等）
- 身体：体型
- 配饰：眼镜、首饰等
- 服装：风格、标志单品

**重要**：选择"特殊标记"（如疤痕）会在 Step 4 触发相关问题

---

### Step 3: 心理特征
选择角色的心理特征（支持多选）：
- 恐惧对象
- 心理创伤
- 喜好
- 厌恶
- 社会评价
- 随身物品

**重要**：这些选择会在 Step 4 触发相关问题

---

### Step 4: 深度细化（新的 5 步交互流程）

根据 Step 2/3 的选择，AI 会生成相关问题。每个问题都经过以下流程：

#### 步骤 1: AI 问问题，你简要回答
- AI 提出问题（如："请描述这个疤痕是如何形成的？"）
- 你输入简要回答（如："五年前在战斗中被敌人的剑划伤"）
- 点击"提交回答"

#### 步骤 2: AI 生成详细内容
- AI 根据你的回答生成 150-200 字的详细描述
- 自动显示生成的内容

#### 步骤 3: 查看并选择
- 查看 AI 生成的内容
- 选择：
  - ✅ **满意，通过** → 直接进入下一题
  - ❌ **不满意，需要修改** → 进入步骤 4

#### 步骤 4: 选择修改方式
如果不满意，选择修改方式：

**📝 小改：直接修改文本**
- 适合：改几个字、调整语句、修正细节
- 操作：在文本框中直接编辑，保存后进入下一题

**💬 大改：给 AI 提建议**
- 适合：改变方向、增加内容、重新构思
- 操作：输入修改建议（如"增加更多情感描写"），AI 重新生成
- 可以多次迭代直到满意

#### 步骤 5: 完成
- 所有问题回答完毕后显示摘要
- 查看所有问答内容
- 点击"下一步"进入 Step 5

---

### Step 5: 报告生成
选择报告格式，AI 生成完整的角色报告：

**6 种报告格式**：
1. **小说风格** - 800-1000 字的第三人称角色描述
2. **TRPG 角色卡片** - 结构化的跑团角色卡
3. **官方档案报告** - 正式的人物档案
4. **人物访谈记录** - 问答形式的访谈
5. **角色日记** - 第一人称日记
6. **医疗/心理档案** - 专业医学档案

**报告内容包含**：
- Step 1: 基础信息
- Step 2: 外貌描述
- Step 3: 心理特征
- Step 4: 深度细节（问答内容）

**操作**：
- 点击"复制报告"复制到剪贴板
- 点击"下载报告"保存为 TXT 文件

---

## 导出/导入

### 导出角色
- 点击右上角的下载图标
- 保存为 JSON 文件
- 包含所有数据（包括 Step 4 问答）

### 导入角色
- 点击右上角的上传图标
- 选择之前导出的 JSON 文件
- 所有数据自动恢复

---

## Step 4 使用技巧

### 如何写好简要回答？
**好的回答**：
- ✅ "五年前在战斗中被敌人的剑划伤"
- ✅ "小时候目睹了父母的争吵"
- ✅ "这是父亲留给我的遗物"

**不需要**：
- ❌ 写得太详细（AI 会帮你扩展）
- ❌ 写得太长（简要描述即可）

### 什么时候用"小改"？
- ✅ 内容基本满意，只需微调
- ✅ 改几个字或词
- ✅ 调整语句顺序
- ✅ 修正事实错误

### 什么时候用"大改"？
- ✅ 内容方向不对
- ✅ 需要增加大量新内容
- ✅ 情感基调需要改变
- ✅ 需要重新构思

### 如何写好修改建议？
**好的建议**：
- ✅ "增加更多情感描写"
- ✅ "改成悲伤的语气"
- ✅ "加入童年回忆的细节"
- ✅ "强调他对这道疤痕的复杂情感"

**不好的建议**：
- ❌ "改一下"（太模糊）
- ❌ "不好"（没有具体方向）
- ❌ "重写"（AI 不知道怎么改）

---

## 常见问题

### Q: Step 4 没有生成任何问题？
A: 需要在 Step 2/3 选择特殊选项（如疤痕、创伤、物品等）才会触发问题

### Q: AI 生成失败怎么办？
A: 检查网络连接，或使用测试工具 `test-api.html` 测试 API 连接

### Q: 可以跳过问题吗？
A: 可以，在 Step 4 的步骤 1 有"跳过此问题"按钮

### Q: 可以返回上一个问题吗？
A: 可以，在 Step 4 的步骤 1 有"返回上一个问题"按钮（第 2 题及以后）

### Q: "大改"可以重复多次吗？
A: 可以，每次重新生成后都会返回步骤 3，可以继续选择"不满意"

### Q: 导出的 JSON 文件包含什么？
A: 包含所有 5 个步骤的数据，包括 Step 4 的问答内容

---

## 测试工具

### test-step4-new-flow.html
独立测试 Step 4 的新交互流程
- 快速体验 5 步流程
- 查看 JSON 数据日志
- 适合熟悉功能

### test-api.html
测试 API 连接
- 验证 API 配置是否正确
- 测试网络连接
- 查看错误信息

### test-render.html
测试渲染功能
- 验证选项渲染是否正常
- 测试多选功能
- 查看数据结构

### quick-test.html
快速功能验证
- 一键测试所有核心功能
- 快速发现问题

---

## 技术说明

### 数据结构
```javascript
{
  version: "7.0",
  basic: { name, gender, age, height, race, alignment, archetype },
  stats: { strength, agility, ... },
  personality: { introvert_extrovert, calm_impulsive, ... },
  selections: { "hair-length": [...], "eye-color": [...], ... },
  questionAnswers: {
    "scars": {
      category: "疤痕来源",
      question: "...",
      userAnswer: "...",
      answer: "...",
      source: "approved" | "manual-edit"
    }
  }
}
```

### API 调用
- 使用 DeepSeek Chat API
- Temperature: 0.8
- 每次生成约消耗 500-1000 tokens

---

## 更新日志

### V7.0 (当前版本)
- ✅ 全新的 Step 4 交互流程（5 步人机协作）
- ✅ 支持小改（直接编辑）和大改（给建议）
- ✅ 可以多次迭代优化
- ✅ 完整的导出/导入功能
- ✅ 6 种报告格式

### V6.1
- Step 4 自动生成深度细节
- 多选功能
- 基础导出/导入

---

## 联系与反馈

如有问题或建议，请查看：
- `README.md` - 项目概述
- `CHANGELOG.md` - 详细更新记录
- `新交互流程说明.md` - Step 4 技术文档

---

**开始创造你的角色吧！** 🎉
